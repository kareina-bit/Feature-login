<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shipway - ฤฤng nhแบญp / ฤฤng kรฝ</title>
  <link rel="stylesheet" href="auth.css">
</head>

<body>
<div class="page">

  <!-- ===== HEADER ===== -->
  <div class="header">
    <img src="img/logo.png" alt="Shipway" class="logo-img">
    <p class="desc" id="headerDesc">
      ฤฤng nhแบญp tรi khoแบฃn Shipway<br>
      ฤแป sแปญ dแปฅng cรกc dแปch vแปฅ vแบญn chuyแปn
    </p>
  </div>

  <!-- ===== OTP NOTIFICATION ===== -->
  <div id="otpNotification" class="otp-notification hidden">
    <div class="otp-notification-content">
      <h3>๐ฑ Mรฃ OTP ฤรฃ ฤฦฐแปฃc gแปญi</h3>
      <p>Sแป ฤiแปn thoแบกi: <strong id="otpPhoneDisplay"></strong></p>
      <p>Mรฃ OTP: <strong id="otpCodeDisplay" class="otp-code"></strong></p>
      <p class="otp-note">(Mรฃ nรy chแป hiแปn thแป ฤแป test, kiแปm tra Console ฤแป xem chi tiแบฟt)</p>
      <button onclick="closeOtpNotification()" class="btn-primary">ฤรฃ ghi nhแบญn</button>
    </div>
  </div>

  <!-- ===== LOGIN VIEW ===== -->
  <div class="card" id="loginView">
    <a href="../onboarding-fe/index.html" class="back-home-btn" title="Quay vแป trang chแปง">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <line x1="19" y1="12" x2="5" y2="12"></line>
      <polyline points="12 19 5 12 12 5"></polyline>
    </svg>
  </a>
    <h2>ฤฤng nhแบญp</h2>

    <form id="loginForm" novalidate>
      <div class="input-group phone-group">
        <select id="loginCountry" class="country-select">
          <option value="+84">๐ป๐ณ +84</option>
          <option value="+1">๐บ๐ธ +1</option>
          <option value="+82">๐ฐ๐ท +82</option>
          <option value="+81">๐ฏ๐ต +81</option>
        </select>
        <input id="loginPhone" type="tel" placeholder="Sแป ฤiแปn thoแบกi" required>
      </div>

      <div class="input-group">
        <input id="loginPassword" type="password" placeholder="Mแบญt khแบฉu" required>
      </div>

      <button type="submit" class="btn-primary">ฤฤng nhแบญp</button>

      <div id="loginMessage" class="form-message"></div>
    </form>

    <a href="#" id="forgotLink" class="link">Quรชn mแบญt khแบฉu?</a>

    <div class="divider"></div>

    <a href="#" class="link strong" onclick="window.showRegister()">
      Chฦฐa cรณ tรi khoแบฃn? ฤฤng kรฝ
    </a>
  </div>

  <!-- ===== REGISTER VIEW ===== -->
  <div class="card hidden" id="registerView">
     <a href="../onboarding-fe/index.html" class="back-home-btn" title="Quay vแป trang chแปง">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <line x1="19" y1="12" x2="5" y2="12"></line>
      <polyline points="12 19 5 12 12 5"></polyline>
    </svg>
  </a>
    <h2>ฤฤng kรฝ tรi khoแบฃn</h2>

    <!-- Role Selector -->
    <div class="role-selector">
      <label class="role-option">
        <input type="radio" name="role" value="user" checked style="display: none;">
        <span class="role-label">ฤแปi tรกc vแบญn chuyแปn</span>
      </label>
      <label class="role-option">
        <input type="radio" name="role" value="driver" style="display: none;">
        <span class="role-label">ฤฤng kรฝ tรi xแบฟ</span>
      </label>
    </div>

    <form id="registerForm" novalidate>
      <!-- Phone Input -->
      <div class="input-group phone-group">
        <select id="regCountry" class="country-select">
          <option value="+84">๐ป๐ณ +84</option>
          <option value="+1">๐บ๐ธ +1</option>
          <option value="+82">๐ฐ๐ท +82</option>
          <option value="+81">๐ฏ๐ต +81</option>
        </select>
        <input id="regPhone" type="tel" placeholder="Sแป ฤiแปn thoแบกi" required>
      </div>

      <div id="regPhoneMessage" class="form-message"></div>

      <!-- Send OTP Button -->
      <button type="button" class="btn-primary" id="sendOtpBtn">
        Gแปญi mรฃ OTP
      </button>

      <!-- OTP Input Section -->
      <div id="otpSection" class="hidden">
        <div class="input-group">
          <input id="regOtpInput" type="text" placeholder="Nhแบญp mรฃ OTP" maxlength="6" pattern="\d{6}" required>
        </div>
      </div>

      <!-- Name Input (appears after OTP section) -->
      <div id="nameSection" class="hidden">
        <div class="input-group">
          <input id="regName" type="text" placeholder="Hแป vร tรชn" required>
        </div>
      </div>

      <!-- Password Input (appears after OTP section) -->
      <div id="passwordSection" class="hidden">
        <div class="input-group">
          <input id="regPassword" type="password" placeholder="Mแบญt khแบฉu" required>
        </div>
      </div>

      <!-- Submit Button (appears after OTP section) -->
      <button type="submit" class="btn-primary hidden" id="registerSubmitBtn">
        ฤฤng kรฝ
      </button>

      <div id="registerMessage" class="form-message"></div>
    </form>

    <a href="#" class="link strong" onclick="window.showLogin()">
      Quay lแบกi ฤฤng nhแบญp
    </a>
  </div>

  <!-- ===== RESET PASSWORD VIEW ===== -->
  <div class="card hidden" id="resetView">
    <h2>ฤแบทt lแบกi mแบญt khแบฉu</h2>

    <form id="resetForm" novalidate>
      <!-- Phone Input -->
      <div class="input-group phone-group">
        <select id="resetCountry" class="country-select">
          <option value="+84">๐ป๐ณ +84</option>
          <option value="+1">๐บ๐ธ +1</option>
          <option value="+82">๐ฐ๐ท +82</option>
          <option value="+81">๐ฏ๐ต +81</option>
        </select>
        <input id="resetPhone" type="tel" placeholder="Sแป ฤiแปn thoแบกi" required>
      </div>

      <!-- Send OTP Button -->
      <button type="button" class="btn-primary" id="resetSendOtpBtn">
        Gแปญi mรฃ OTP
      </button>

      <!-- OTP Input Section -->
      <div id="resetOtpSection" class="hidden">
        <div class="input-group">
          <input id="resetOtpInput" type="text" placeholder="Nhแบญp mรฃ OTP" maxlength="6" pattern="\d{6}" required>
        </div>
      </div>

      <!-- New Password Section -->
      <div id="newPasswordSection" class="hidden">
        <div class="input-group">
          <input id="resetPassword" type="password" placeholder="Mแบญt khแบฉu mแปi" required>
        </div>
      </div>

      <!-- Submit Button -->
      <button type="submit" class="btn-primary hidden" id="resetSubmitBtn">
        ฤแบทt lแบกi mแบญt khแบฉu
      </button>

      <div id="resetMessage" class="form-message"></div>
    </form>

    <a href="#" class="link strong" onclick="window.showLogin()">
      Quay lแบกi ฤฤng nhแบญp
    </a>
  </div>

</div>

<!-- Script -->
<script type="module">
  import { initAuthService } from './auth.controller.js';
  import { eventBus, AUTH_EVENTS } from '../shared/event-bus.js';

  // Initialize Auth Service
  document.addEventListener('DOMContentLoaded', () => {
    initAuthService();
  });

  // Function to show OTP notification
  window.showOtpNotification = function(phone, otp) {
    const notification = document.getElementById('otpNotification');
    const phoneDisplay = document.getElementById('otpPhoneDisplay');
    const codeDisplay = document.getElementById('otpCodeDisplay');

    if (notification && phoneDisplay && codeDisplay) {
      phoneDisplay.textContent = phone;
      codeDisplay.textContent = otp;
      notification.classList.remove('hidden');
    }
  };

  // Function to close OTP notification
  window.closeOtpNotification = function() {
    const notification = document.getElementById('otpNotification');
    if (notification) {
      notification.classList.add('hidden');
    }
  };
  window.addEventListener('DOMContentLoaded', () => {
    if (location.hash === '#register') showRegister();
  });
</script>
</body>
</html>
