<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shipway - ÄÄƒng nháº­p / ÄÄƒng kÃ½</title>
  <link rel="stylesheet" href="assets/css/auth.css">
</head>

<body>
<div class="page">

  <!-- ===== HEADER ===== -->
  <div class="header">
    <img src="img/logo.png" alt="Shipway" class="logo-img">
    <p class="desc" id="headerDesc">
      ÄÄƒng nháº­p tÃ i khoáº£n Shipway<br>
      Ä‘á»ƒ sá»­ dá»¥ng cÃ¡c dá»‹ch vá»¥ váº­n chuyá»ƒn
    </p>
  </div>

  <!-- ===== OTP NOTIFICATION ===== -->
  <div id="otpNotification" class="otp-notification hidden">
    <div class="otp-notification-content">
      <h3>ğŸ“± MÃ£ OTP Ä‘Ã£ Ä‘Æ°á»£c gá»­i</h3>
      <p>Sá»‘ Ä‘iá»‡n thoáº¡i: <strong id="otpPhoneDisplay"></strong></p>
      <p>MÃ£ OTP: <strong id="otpCodeDisplay" class="otp-code"></strong></p>
      <p class="otp-note">(MÃ£ nÃ y chá»‰ hiá»ƒn thá»‹ Ä‘á»ƒ test, kiá»ƒm tra Console Ä‘á»ƒ xem chi tiáº¿t)</p>
      <button onclick="closeOtpNotification()" class="btn-primary">ÄÃ£ ghi nháº­n</button>
    </div>
  </div>

  <!-- ===== LOGIN VIEW ===== -->
  <div class="card" id="loginView">
    <a href="../onboarding-fe/index.html" class="back-home-btn" title="Quay vá» trang chá»§">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <line x1="19" y1="12" x2="5" y2="12"></line>
      <polyline points="12 19 5 12 12 5"></polyline>
    </svg>
  </a>
    <h2>ÄÄƒng nháº­p</h2>

    <form id="loginForm" novalidate>
      <div class="input-group phone-group">
        <select id="loginCountry" class="country-select">
          <option value="+84">ğŸ‡»ğŸ‡³ +84</option>
          <option value="+1">ğŸ‡ºğŸ‡¸ +1</option>
          <option value="+82">ğŸ‡°ğŸ‡· +82</option>
          <option value="+81">ğŸ‡¯ğŸ‡µ +81</option>
        </select>
        <input id="loginPhone" type="tel" placeholder="Sá»‘ Ä‘iá»‡n thoáº¡i" required>
      </div>

      <div class="input-group">
        <input id="loginPassword" type="password" placeholder="Máº­t kháº©u" required>
      </div>

      <button type="submit" class="btn-primary">ÄÄƒng nháº­p</button>

      <div id="loginMessage" class="form-message"></div>
    </form>

    <a href="#" id="forgotLink" class="link">QuÃªn máº­t kháº©u?</a>

    <div class="divider"></div>

    <a href="#" class="link strong" onclick="window.showRegister()">
      ChÆ°a cÃ³ tÃ i khoáº£n? ÄÄƒng kÃ½
    </a>
  </div>

  <!-- ===== REGISTER VIEW ===== -->
  <div class="card hidden" id="registerView">
    <h2>ÄÄƒng kÃ½ tÃ i khoáº£n</h2>

    <!-- Role Selector -->
    <div class="role-selector">
      <label class="role-option">
        <input type="radio" name="role" value="user" checked style="display: none;">
        <span class="role-label">Äá»‘i tÃ¡c váº­n chuyá»ƒn</span>
      </label>
      <label class="role-option">
        <input type="radio" name="role" value="driver" style="display: none;">
        <span class="role-label">ÄÄƒng kÃ½ tÃ i xáº¿</span>
      </label>
    </div>

    <form id="registerForm" novalidate>
      <!-- Phone Input -->
      <div class="input-group phone-group">
        <select id="regCountry" class="country-select">
          <option value="+84">ğŸ‡»ğŸ‡³ +84</option>
          <option value="+1">ğŸ‡ºğŸ‡¸ +1</option>
          <option value="+82">ğŸ‡°ğŸ‡· +82</option>
          <option value="+81">ğŸ‡¯ğŸ‡µ +81</option>
        </select>
        <input id="regPhone" type="tel" placeholder="Sá»‘ Ä‘iá»‡n thoáº¡i" required>
      </div>

      <div id="regPhoneMessage" class="form-message"></div>

      <!-- Send OTP Button -->
      <button type="button" class="btn-primary" id="sendOtpBtn">
        Gá»­i mÃ£ OTP
      </button>

      <!-- OTP Input Section -->
      <div id="otpSection" class="hidden">
        <div class="input-group">
          <input id="regOtpInput" type="text" placeholder="Nháº­p mÃ£ OTP" maxlength="6" pattern="\d{6}" required>
        </div>
      </div>

      <!-- Name Input (appears after OTP section) -->
      <div id="nameSection" class="hidden">
        <div class="input-group">
          <input id="regName" type="text" placeholder="Há» vÃ  tÃªn" required>
        </div>
      </div>

      <!-- Password Input (appears after OTP section) -->
      <div id="passwordSection" class="hidden">
        <div class="input-group">
          <input id="regPassword" type="password" placeholder="Máº­t kháº©u" required>
        </div>
      </div>

      <!-- Submit Button (appears after OTP section) -->
      <button type="submit" class="btn-primary hidden" id="registerSubmitBtn">
        ÄÄƒng kÃ½
      </button>

      <div id="registerMessage" class="form-message"></div>
    </form>

    <a href="#" class="link strong" onclick="window.showLogin()">
      Quay láº¡i Ä‘Äƒng nháº­p
    </a>
  </div>

  <!-- ===== RESET PASSWORD VIEW ===== -->
  <div class="card hidden" id="resetView">
    <h2>Äáº·t láº¡i máº­t kháº©u</h2>

    <form id="resetForm" novalidate>
      <!-- Phone Input -->
      <div class="input-group phone-group">
        <select id="resetCountry" class="country-select">
          <option value="+84">ğŸ‡»ğŸ‡³ +84</option>
          <option value="+1">ğŸ‡ºğŸ‡¸ +1</option>
          <option value="+82">ğŸ‡°ğŸ‡· +82</option>
          <option value="+81">ğŸ‡¯ğŸ‡µ +81</option>
        </select>
        <input id="resetPhone" type="tel" placeholder="Sá»‘ Ä‘iá»‡n thoáº¡i" required>
      </div>

      <!-- Send OTP Button -->
      <button type="button" class="btn-primary" id="resetSendOtpBtn">
        Gá»­i mÃ£ OTP
      </button>

      <!-- OTP Input Section -->
      <div id="resetOtpSection" class="hidden">
        <div class="input-group">
          <input id="resetOtpInput" type="text" placeholder="Nháº­p mÃ£ OTP" maxlength="6" pattern="\d{6}" required>
        </div>
      </div>

      <!-- New Password Section -->
      <div id="newPasswordSection" class="hidden">
        <div class="input-group">
          <input id="resetPassword" type="password" placeholder="Máº­t kháº©u má»›i" required>
        </div>
      </div>

      <!-- Submit Button -->
      <button type="submit" class="btn-primary hidden" id="resetSubmitBtn">
        Äáº·t láº¡i máº­t kháº©u
      </button>

      <div id="resetMessage" class="form-message"></div>
    </form>

    <a href="#" class="link strong" onclick="window.showLogin()">
      Quay láº¡i Ä‘Äƒng nháº­p
    </a>
  </div>

</div>

<!-- Script -->
<script type="module">
  import { initAuthService } from './assets/js/auth.controller.js';

  // Initialize Auth Service
  document.addEventListener('DOMContentLoaded', () => {
    initAuthService();
  });

  // Function to show OTP notification
  window.showOtpNotification = function(phone, otp) {
    const notification = document.getElementById('otpNotification');
    const phoneDisplay = document.getElementById('otpPhoneDisplay');
    const codeDisplay = document.getElementById('otpCodeDisplay');

    if (notification && phoneDisplay && codeDisplay) {
      phoneDisplay.textContent = phone;
      codeDisplay.textContent = otp;
      notification.classList.remove('hidden');
    }
  };

  // Function to close OTP notification
  window.closeOtpNotification = function() {
    const notification = document.getElementById('otpNotification');
    if (notification) {
      notification.classList.add('hidden');
    }
  };
</script>
</body>
</html>
